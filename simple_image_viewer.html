<!DOCTYPE html>
<head>
  <meta charset="UTF-8">
</head>
<body>
  <img id="image">

  <script type="text/javascript">
    (function(){
      "use strict";

      // e.g.
      // ./画像ファイル名_001.jpg
      var file_path         = "./画像ファイル名_";
      var zero_suppress_num = 3;
      var file_extension    = ".jpg";

      function get_page_from_hash() {
        var page_string = window.document.location.hash.substring(1);
        var page        = parseInt(page_string, 10);

        if (isFinite(page) === false || page < 1) {
          page = 1;
        }

        return page;
      }

      function set_page_to_hash(page) {
        var zero_paddinged_page = get_zero_padding_page(page);
        var path_hash = "#" + zero_paddinged_page;

        update_image(zero_paddinged_page);
        history.pushState(null, null, path_hash);
      }

      function get_zero_padding_page(page) {
        return (zero_padding_string + page).slice(-zero_suppress_num);
      }

      function update_image(zero_paddinged_page) {
        image.src = file_path + zero_paddinged_page + file_extension;
      }

      function set_image_margin_bottom() {
        image.style.marginBottom = window.innerHeight + "px";
      }

      function set_onmousemove() {
        window.document.onmousemove = function(e) {
          if (e.clientX < window.innerWidth / 2) {
            // カーソルが左半分にある / 左向きカーソル
            image.style.cursor = "w-resize";
          }
          else {
            // カーソルが右半分にある / 右向きカーソル
            image.style.cursor = "e-resize";
          }
        };
      }

      function set_onmousedown() {
        window.document.onmousedown = function(e) {
          var page = get_page_from_hash();

          if (e.clientX < window.innerWidth / 2) {
            // 左半分クリック / 前のページ
            if (page === 1) {
              return;
            }

            set_page_to_hash(page - 1);

            // 画面は一番下にスクロールした状態にする
            // 左クリック時には一旦、画像下のマージンを0にしておく
            image.style.marginBottom = "0px";

            // 一番下にスクロール
            window.scrollTo(0, window.document.body.clientHeight);

            // スクロールが終わってから画像下のマージンをリセットする
            set_image_margin_bottom();
          }
          else {
            // 右半分クリック / 次のページ
            set_page_to_hash(page + 1);

            // 画面はスクロールしていない状態にする
            window.scrollTo(0, 0);
          }
        };
      }

      function set_onresize() {
        window.onresize = function(e) {
          set_image_margin_bottom();
        };
      }

      function initialize() {
        image = window.document.getElementById("image");
        image.style.width = "100%";
        set_image_margin_bottom();

        // 画像と背景の境目が分かりやすいように背景色を設定する。とりあえず灰色
        window.document.body.style.backgroundColor = "#dddddd";

        zero_padding_string = new Array(zero_suppress_num).fill("0").join("");

        var page = get_page_from_hash();

        set_page_to_hash(page);
      }

      var image;
      var zero_padding_string;

      initialize();

      set_onmousemove();
      set_onmousedown();
      set_onresize();
    })();
  </script>
</body>
</heml>
